# prompt_beautifier

## Тренировка LoRa над Qwen3-1.7B для улучшения промптов пользователя
## Проект для курса "Инфраструктура ML"

### Попробовать можно [тут](https://ananasclassic.github.io/prompt_beautifier/)

### Примеры

| промпт                       | улучшенный промпт                |
|------------------------------|----------------------------------|
| Как подготовиться к экзамену за 3 дня?| Предоставь подробный план подготовки к экзамену за 3 дня, включая конкретные шаги по организации времени, методам повторения, проверке знаний и улучшению концентрации. Укажи рекомендации по ежедневной рутине, выбору материалов для повторения, а также советы по психологической подготовке и управлению стрессом. (Если есть особенности экзамена или предмета — уточни, чтобы адаптировать рекомендации.)|
| Помоги с годовым отчётом| Помоги составить подробный годовой отчёт, включающий следующие разделы: введение, основные достижения, ключевые проекты и их результаты, трудности и решения, финансовые результаты, анализ внутренней и внешней среды, а также выводы и рекомендации. Укажи, для какой отрасли или типа деятельности предназначен отчёт, и какие конкретные показатели или данные важны для оценки. (Если есть предпочтения по стилю или формату отчёта — уточни.)|
|Кто победит, сто человек или одна горилла?|Сравний, кто будет победителем в этой битве: 100 человек или одна горилла. Учитывай следующие факторы:<br><br>1. Способности и уровень развития каждого участника.<br>2. Условия битвы (место, время, доступные ресурсы).<br>3. Способность к выживанию и адаптации.<br>4. Возможные стратегии и атаки.<br>5. Дополнительные факторы, влияющие на исход.<br><br>(Если есть предпочтения по типу горилл или конкретным условиям — уточни.)|

### Настройка окружения через conda:

```bash
conda deactivate
conda create -n prompt_beautifier python=3.10
conda activate prompt_beautifier
pip install --upgrade pip
pip install -r requirements.txt
```

### Воспроизведение тренировки:

```bash
python train.py --model-name Qwen/Qwen3-1.7B --data-path data/prompt_dataset_chain_0-8000.json
```

### Инференс через vllm-сервер

```bash
python vllm_server_setup.py --adapter-path qwen3-lora-adapter --port 8000
```
Чтобы получить улучшенный промпт отправьте POST-запрос на  `http://localhost:8000/improve` с JSON-ом вида `{"prompt": "..."}`.
